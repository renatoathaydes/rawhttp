<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#39424E">
    <link rel="shortcut icon" href="/rawhttp/sam.ico" id="favicon">
    <title>RawHTTP</title>
    <link rel="stylesheet" href="/rawhttp/css/styles.css">
</head>
<body>
<div class="main-body"><nav class="main-nav">
    <a href="/rawhttp/index.html">Home</a>
    <a href="/rawhttp/docs/index.html">Docs</a>
    <a href="/rawhttp/rawhttp-modules/cli.html">CLI</a>
    <a href="/rawhttp/rawhttp-modules/duplex.html">Duplex</a>
    <a href="/rawhttp/rawhttp-modules/cookies.html">Cookies</a>
    <a href="/rawhttp/rawhttp-modules/req-in-edit.html">ReqInEdit</a>
</nav><h3>Send a GET request</h3>
<pre tabindex="0" style="color:#93a1a1;background-color:#002b36;"><code><span style="display:flex;"><span><span style="color:#719e07">import</span> rawhttp.core.*<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span><span style="color:#719e07">import</span> java.net.Socket<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>RawHttp http <span style="color:#719e07">=</span> <span style="color:#719e07">new</span> RawHttp<span style="color:#719e07">(</span><span style="color:#719e07">)</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>RawHttpRequest request <span style="color:#719e07">=</span> http<span style="color:#719e07">.</span>parseRequest<span style="color:#719e07">(</span>
</span></span><span style="display:flex;"><span>    <span style="color:#2aa198">&#34;GET / HTTP/1.1\r\n&#34;</span> <span style="color:#719e07">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#2aa198">&#34;Host: headers.jsontest.com\r\n&#34;</span> <span style="color:#719e07">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#2aa198">&#34;User-Agent: RawHTTP\r\n&#34;</span> <span style="color:#719e07">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#2aa198">&#34;Accept: application/json&#34;</span><span style="color:#719e07">)</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Socket socket <span style="color:#719e07">=</span> <span style="color:#719e07">new</span> Socket<span style="color:#719e07">(</span><span style="color:#2aa198">&#34;headers.jsontest.com&#34;</span><span style="color:#719e07">,</span> 80<span style="color:#719e07">)</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>request<span style="color:#719e07">.</span>writeTo<span style="color:#719e07">(</span>socket<span style="color:#719e07">.</span>getOutputStream<span style="color:#719e07">(</span><span style="color:#719e07">)</span><span style="color:#719e07">)</span><span style="color:#719e07">;</span>
</span></span></code></pre>
<h3>Send a POST request with a body</h3>
<pre tabindex="0" style="color:#93a1a1;background-color:#002b36;"><code><span style="display:flex;"><span><span style="color:#719e07">import</span> rawhttp.core.*<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span><span style="color:#719e07">import</span> java.net.Socket<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>String jsonBody <span style="color:#719e07">=</span> <span style="color:#2aa198">&#34;{ \&#34;hello\&#34;: true, \&#34;raw_http\&#34;: \&#34;2.0\&#34; }&#34;</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>RawHttp http <span style="color:#719e07">=</span> <span style="color:#719e07">new</span> RawHttp<span style="color:#719e07">(</span><span style="color:#719e07">)</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>RawHttpRequest request <span style="color:#719e07">=</span> http<span style="color:#719e07">.</span>parseRequest<span style="color:#719e07">(</span>
</span></span><span style="display:flex;"><span>    <span style="color:#2aa198">&#34;POST /post HTTP/1.1\r\n&#34;</span> <span style="color:#719e07">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#2aa198">&#34;Host: httpbin.org\r\n&#34;</span> <span style="color:#719e07">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#2aa198">&#34;User-Agent: RawHTTP\r\n&#34;</span> <span style="color:#719e07">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#2aa198">&#34;Content-Length: &#34;</span> <span style="color:#719e07">+</span> jsonBody<span style="color:#719e07">.</span>length<span style="color:#719e07">(</span><span style="color:#719e07">)</span> <span style="color:#719e07">+</span> <span style="color:#2aa198">&#34;\r\n&#34;</span> <span style="color:#719e07">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#2aa198">&#34;Content-Type: application/json\r\n&#34;</span> <span style="color:#719e07">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#2aa198">&#34;Accept: application/json\r\n&#34;</span> <span style="color:#719e07">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#2aa198">&#34;\r\n&#34;</span> <span style="color:#719e07">+</span>
</span></span><span style="display:flex;"><span>    jsonBody<span style="color:#719e07">)</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Socket socket <span style="color:#719e07">=</span> <span style="color:#719e07">new</span> Socket<span style="color:#719e07">(</span><span style="color:#2aa198">&#34;httpbin.org&#34;</span><span style="color:#719e07">,</span> 80<span style="color:#719e07">)</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>request<span style="color:#719e07">.</span>writeTo<span style="color:#719e07">(</span>socket<span style="color:#719e07">.</span>getOutputStream<span style="color:#719e07">(</span><span style="color:#719e07">)</span><span style="color:#719e07">)</span><span style="color:#719e07">;</span>
</span></span></code></pre>
<h3>Read a response</h3>

<p>&hellip; continues from the previous example:</p>
<pre tabindex="0" style="color:#93a1a1;background-color:#002b36;"><code><span style="display:flex;"><span>RawHttpResponse<span style="color:#719e07">&lt;</span><span style="color:#719e07">?</span><span style="color:#719e07">&gt;</span> response <span style="color:#719e07">=</span> http<span style="color:#719e07">.</span>parseResponse<span style="color:#719e07">(</span>socket<span style="color:#719e07">.</span>getInputStream<span style="color:#719e07">(</span><span style="color:#719e07">)</span><span style="color:#719e07">)</span><span style="color:#719e07">.</span>eagerly<span style="color:#719e07">(</span><span style="color:#719e07">)</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>System<span style="color:#719e07">.</span>out<span style="color:#719e07">.</span>println<span style="color:#719e07">(</span><span style="color:#2aa198">&#34;RESPONSE:\n&#34;</span> <span style="color:#719e07">+</span> response<span style="color:#719e07">)</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>assertEquals<span style="color:#719e07">(</span>200<span style="color:#719e07">,</span> response<span style="color:#719e07">.</span>getStatusCode<span style="color:#719e07">(</span><span style="color:#719e07">)</span><span style="color:#719e07">)</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>assertTrue<span style="color:#719e07">(</span>response<span style="color:#719e07">.</span>getBody<span style="color:#719e07">(</span><span style="color:#719e07">)</span><span style="color:#719e07">.</span>isPresent<span style="color:#719e07">(</span><span style="color:#719e07">)</span><span style="color:#719e07">)</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>String textBody <span style="color:#719e07">=</span> response<span style="color:#719e07">.</span>getBody<span style="color:#719e07">(</span><span style="color:#719e07">)</span><span style="color:#719e07">.</span>get<span style="color:#719e07">(</span><span style="color:#719e07">)</span><span style="color:#719e07">.</span>decodeBodyToString<span style="color:#719e07">(</span>UTF_8<span style="color:#719e07">)</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>assertTrue<span style="color:#719e07">(</span>textBody<span style="color:#719e07">.</span>contains<span style="color:#719e07">(</span>jsonBody<span style="color:#719e07">.</span>replaceAll<span style="color:#719e07">(</span><span style="color:#2aa198">&#34; &#34;</span><span style="color:#719e07">,</span> <span style="color:#2aa198">&#34;&#34;</span><span style="color:#719e07">)</span><span style="color:#719e07">)</span><span style="color:#719e07">)</span><span style="color:#719e07">;</span>
</span></span></code></pre>
<h3>Check headers (in both request or response)</h3>

<p>&hellip; continues from the previous examples:</p>
<pre tabindex="0" style="color:#93a1a1;background-color:#002b36;"><code><span style="display:flex;"><span>assertEquals<span style="color:#719e07">(</span><span style="color:#2aa198">&#34;application/json&#34;</span><span style="color:#719e07">,</span>
</span></span><span style="display:flex;"><span>    request<span style="color:#719e07">.</span>getHeaders<span style="color:#719e07">(</span><span style="color:#719e07">)</span><span style="color:#719e07">.</span>getFirst<span style="color:#719e07">(</span><span style="color:#2aa198">&#34;Accept&#34;</span><span style="color:#719e07">)</span><span style="color:#719e07">.</span>orElse<span style="color:#719e07">(</span><span style="color:#2aa198">&#34;&#34;</span><span style="color:#719e07">)</span><span style="color:#719e07">)</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>assertEquals<span style="color:#719e07">(</span><span style="color:#2aa198">&#34;application/json&#34;</span><span style="color:#719e07">,</span>
</span></span><span style="display:flex;"><span>    response<span style="color:#719e07">.</span>getHeaders<span style="color:#719e07">(</span><span style="color:#719e07">)</span><span style="color:#719e07">.</span>getFirst<span style="color:#719e07">(</span><span style="color:#2aa198">&#34;Content-Type&#34;</span><span style="color:#719e07">)</span><span style="color:#719e07">.</span>orElse<span style="color:#719e07">(</span><span style="color:#2aa198">&#34;&#34;</span><span style="color:#719e07">)</span><span style="color:#719e07">)</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>assertEquals<span style="color:#719e07">(</span>asList<span style="color:#719e07">(</span><span style="color:#2aa198">&#34;application/json&#34;</span><span style="color:#719e07">)</span><span style="color:#719e07">,</span>
</span></span><span style="display:flex;"><span>    response<span style="color:#719e07">.</span>getHeaders<span style="color:#719e07">(</span><span style="color:#719e07">)</span><span style="color:#719e07">.</span>get<span style="color:#719e07">(</span><span style="color:#2aa198">&#34;Content-Type&#34;</span><span style="color:#719e07">)</span><span style="color:#719e07">)</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>assertEquals<span style="color:#719e07">(</span>asList<span style="color:#719e07">(</span><span style="color:#2aa198">&#34;Host&#34;</span><span style="color:#719e07">,</span> <span style="color:#2aa198">&#34;User-Agent&#34;</span><span style="color:#719e07">,</span> <span style="color:#2aa198">&#34;Content-Length&#34;</span><span style="color:#719e07">,</span> <span style="color:#2aa198">&#34;Content-Type&#34;</span><span style="color:#719e07">,</span> <span style="color:#2aa198">&#34;Accept&#34;</span><span style="color:#719e07">)</span><span style="color:#719e07">,</span>
</span></span><span style="display:flex;"><span>    request<span style="color:#719e07">.</span>getHeaders<span style="color:#719e07">(</span><span style="color:#719e07">)</span><span style="color:#719e07">.</span>getHeaderNames<span style="color:#719e07">(</span><span style="color:#719e07">)</span><span style="color:#719e07">)</span><span style="color:#719e07">;</span>
</span></span></code></pre>
<h3>Specify a specific encoding for header values</h3>

<p>By default, HTTP headers&rsquo;s values are decoded using US-ASCII as that is the <a href="https://tools.ietf.org/html/rfc7230#section-3.2.4">recommendation</a>.</p>

<p>If you need to support other encodings, use a custom <code>RawHttp</code> instance to parse messages, as follows:</p>
<pre tabindex="0" style="color:#93a1a1;background-color:#002b36;"><code><span style="display:flex;"><span>var http <span style="color:#719e07">=</span> <span style="color:#719e07">new</span> RawHttp<span style="color:#719e07">(</span>RawHttpOptions<span style="color:#719e07">.</span>newBuilder<span style="color:#719e07">(</span><span style="color:#719e07">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">.</span>withHttpHeadersOptions<span style="color:#719e07">(</span><span style="color:#719e07">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">.</span>withValuesCharset<span style="color:#719e07">(</span>StandardCharsets<span style="color:#719e07">.</span>UTF_8<span style="color:#719e07">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">.</span>done<span style="color:#719e07">(</span><span style="color:#719e07">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">.</span>build<span style="color:#719e07">(</span><span style="color:#719e07">)</span><span style="color:#719e07">)</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#586e75">// now this will be allowed
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>http<span style="color:#719e07">.</span>parseRequest<span style="color:#719e07">(</span><span style="color:#2aa198">&#34;&#34;</span><span style="color:#2aa198">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#2aa198">     GET / HTTP/1.1
</span></span></span><span style="display:flex;"><span><span style="color:#2aa198">     Accept: こんにちは, text/plain
</span></span></span><span style="display:flex;"><span><span style="color:#2aa198">     User-Agent: RawHTTP
</span></span></span><span style="display:flex;"><span><span style="color:#2aa198">     Host: localhost:$serverPort&#34;</span><span style="color:#2aa198">&#34;&#34;</span><span style="color:#719e07">)</span><span style="color:#719e07">;</span>
</span></span></code></pre>
<h3>Listen for HTTP requests (as a server)</h3>
<pre tabindex="0" style="color:#93a1a1;background-color:#002b36;"><code><span style="display:flex;"><span><span style="color:#719e07">import</span> rawhttp.core.*<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span><span style="color:#719e07">import</span> java.net.ServerSocket<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ServerSocket serverSocket <span style="color:#719e07">=</span> <span style="color:#719e07">new</span> ServerSocket<span style="color:#719e07">(</span>8082<span style="color:#719e07">)</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>RawHttp http <span style="color:#719e07">=</span> <span style="color:#719e07">new</span> RawHttp<span style="color:#719e07">(</span><span style="color:#719e07">)</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>Socket client <span style="color:#719e07">=</span> serverSocket<span style="color:#719e07">.</span>accept<span style="color:#719e07">(</span><span style="color:#719e07">)</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>RawHttpRequest request <span style="color:#719e07">=</span> http<span style="color:#719e07">.</span>parseRequest<span style="color:#719e07">(</span>client<span style="color:#719e07">.</span>getInputStream<span style="color:#719e07">(</span><span style="color:#719e07">)</span><span style="color:#719e07">)</span><span style="color:#719e07">;</span>
</span></span></code></pre>
<h3>Respond to a HTTP request</h3>

<p>&hellip; continues from the previous example:</p>
<pre tabindex="0" style="color:#93a1a1;background-color:#002b36;"><code><span style="display:flex;"><span><span style="color:#719e07">import</span> java.time.*<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span><span style="color:#719e07">import static</span> java.time.format.DateTimeFormatter.RFC_1123_DATE_TIME<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>String body <span style="color:#719e07">=</span> <span style="color:#2aa198">&#34;Hello RawHTTP!&#34;</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>String dateString <span style="color:#719e07">=</span> RFC_1123_DATE_TIME<span style="color:#719e07">.</span>format<span style="color:#719e07">(</span>ZonedDateTime<span style="color:#719e07">.</span>now<span style="color:#719e07">(</span>ZoneOffset<span style="color:#719e07">.</span>UTC<span style="color:#719e07">)</span><span style="color:#719e07">)</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>RawHttpResponse<span style="color:#719e07">&lt;</span><span style="color:#719e07">?</span><span style="color:#719e07">&gt;</span> response <span style="color:#719e07">=</span> http<span style="color:#719e07">.</span>parseResponse<span style="color:#719e07">(</span>
</span></span><span style="display:flex;"><span>    <span style="color:#2aa198">&#34;HTTP/1.1 200 OK\r\n&#34;</span> <span style="color:#719e07">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#2aa198">&#34;Content-Type: plain/text\r\n&#34;</span> <span style="color:#719e07">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#2aa198">&#34;Content-Length: &#34;</span> <span style="color:#719e07">+</span> body<span style="color:#719e07">.</span>length<span style="color:#719e07">(</span><span style="color:#719e07">)</span> <span style="color:#719e07">+</span> <span style="color:#2aa198">&#34;\r\n&#34;</span> <span style="color:#719e07">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#2aa198">&#34;Server: RawHTTP\r\n&#34;</span> <span style="color:#719e07">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#2aa198">&#34;Date: &#34;</span> <span style="color:#719e07">+</span> dateString <span style="color:#719e07">+</span> <span style="color:#2aa198">&#34;\r\n&#34;</span> <span style="color:#719e07">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#2aa198">&#34;\r\n&#34;</span> <span style="color:#719e07">+</span>
</span></span><span style="display:flex;"><span>    body<span style="color:#719e07">)</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>response<span style="color:#719e07">.</span>writeTo<span style="color:#719e07">(</span>client<span style="color:#719e07">.</span>getOutputStream<span style="color:#719e07">(</span><span style="color:#719e07">)</span><span style="color:#719e07">)</span><span style="color:#719e07">;</span>
</span></span></code></pre>
<hr>
</div>
<footer class="footer">
    <div>
        <small>
            RawHTTP is a project by <a href="https://github.com/renatoathaydes">Renato Athaydes</a>
        </small>
    </div>
    <div>
        <small>Sources on <a href="https://github.com/renatoathaydes/rawhttp">GitHub</a></small>
    </div>
</footer>
</body>
</html>