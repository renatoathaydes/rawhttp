<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#39424E">
    <link rel="shortcut icon" href="/rawhttp/sam.ico" id="favicon">
    <title>RawHTTP</title>
    <link rel="stylesheet" href="/rawhttp/css/styles.css">
</head>
<body>
<div class="main-body"><nav class="main-nav">
    <a href="/rawhttp/index.html">Home</a>
    <a href="/rawhttp/docs/index.html">Docs</a>
    <a href="/rawhttp/rawhttp-modules/cli.html">CLI</a>
    <a href="/rawhttp/rawhttp-modules/duplex.html">Duplex</a>
    <a href="/rawhttp/rawhttp-modules/cookies.html">Cookies</a>
    <a href="/rawhttp/rawhttp-modules/req-in-edit.html">ReqInEdit</a>
</nav><h1>RawHTTP CLI</h1>

<p>The <code>rawhttp-cli</code> module is a CLI (command-line interface) that can send HTTP requests and serve
local files via a RawHTTP server.</p>

<h2>Download</h2>

<p>To run on Java 8 through 14:</p>
<pre style="color:#93a1a1;background-color:#002b36">curl -sSfL https://repo1.maven.org/maven2/com/athaydes/rawhttp/rawhttp-cli/1.4.0/rawhttp-cli-1.4.0-all.jar -o rawhttp-all.jar
</pre>
<p>To run on Java 17+:</p>

<blockquote>
<p>A different jar is needed because Nashorn is not included in the JDK anymore, so it must be included in the jar:</p>
</blockquote>
<pre style="color:#93a1a1;background-color:#002b36">curl -sSfL https://repo1.maven.org/maven2/com/athaydes/rawhttp/rawhttp-cli/1.4.0/rawhttp-cli-1.4.0-jdk17.jar -o rawhttp-jdk17.jar
</pre>
<h2>Usage</h2>

<p>Before we start, if your shell supports <code>alias</code>, create an alias for the command to run the RawHTTP CLI:</p>
<pre style="color:#93a1a1;background-color:#002b36"><span style="color:#b58900">alias</span> <span style="color:#268bd2">rawhttp</span><span style="color:#719e07">=</span><span style="color:#2aa198">&#34;</span><span style="color:#2aa198">java -jar </span><span style="color:#719e07">$(</span><span style="color:#b58900">pwd</span><span style="color:#719e07">)</span><span style="color:#2aa198">/rawhttp.jar</span><span style="color:#2aa198">&#34;</span>
</pre>
<p>Now, running the RawHTTP CLI is as easy as typing <code>rawhttp</code>.</p>

<p>The following sub-commands are supported:</p>

<ul>
<li><code>send</code>  - sends a HTTP request from sysin, a file, or an argument.</li>
<li><code>run</code>   - runs a HTTP file in the <a href="https://www.jetbrains.com/help/idea/http-client-in-product-code-editor.html">JetBrains ReqInEdit</a> format.</li>
<li><code>serve</code> - starts a HTTP server to serve the contents of a directory.</li>
<li><code>help</code>  - show help information.</li>
</ul>

<p>To see information about a particular sub-command, <code>send</code> for example:</p>
<pre style="color:#93a1a1;background-color:#002b36">rawhttp <span style="color:#b58900">help</span> send
</pre>
<hr>

<h3>Using the <code>send</code> command</h3>

<p>The <code>send</code> command has the purpose of sending out single HTTP requests.</p>

<p>By default, it prints the full HTTP response (including status line, headers, body) to <code>stdout</code>, but it can also
print only parts of the response, and statistics about the request.</p>

<p>Usage:</p>
<pre style="color:#93a1a1;background-color:#002b36">rawhttp send <span style="color:#719e07">[</span>options<span style="color:#719e07">]</span>
</pre>
<p>Options:</p>
<pre style="color:#93a1a1;background-color:#002b36">* -f --file &lt;file&gt;
      <span style="color:#b58900">read</span> request from a file
* -t --text &lt;request-text&gt;
      <span style="color:#b58900">read</span> request as text
* -p --print-response-mode &lt;option&gt;
      option is one of: response|all|body|status|stats
        - response: <span style="color:#719e07">(</span>default<span style="color:#719e07">)</span> print the full response
        - all: print the full response and statistics about the request
        - body: print the response body
        - status: print the response status-line
        - stats: print statistics about the request
* -l --log-request
      log the request
* -b --body-text &lt;text&gt;
      replace message body with the text
* -g --body-file &lt;file&gt;
      replace message body with the contents of the file
</pre>
<p>Statistics include the following information:</p>

<ul>
<li><code>Connect time</code>: the time it took to connect to the server (includes only the Socket::connect call).</li>
<li><code>First received byte time (FRBT)</code>: the time between the first byte of the request being sent, and the first byte of the response being received.</li>
<li><code>Total response time (TRT)</code>: time to receive the first byte, plus the time to download the full response.</li>
<li><code>Bytes received</code>: the number of bytes received from the server.</li>
<li><code>Throughput</code>: the total number of bytes received, divided by (TRT - FRBT) in seconds.</li>
</ul>

<p>If no <code>-f</code> or <code>-t</code> options are given, a HTTP request is read from stdin.</p>

<h4>Send a HTTP request from a file</h4>
<pre style="color:#93a1a1;background-color:#002b36">rawhttp send -f my-request.req
</pre>
<p>Running this command will print the full HTTP response to stdout.</p>

<p>You can send the HTTP response to another file:</p>
<pre style="color:#93a1a1;background-color:#002b36">rawhttp send my-request.req &gt; my-response.res
</pre>
<p>Or print statistics about it:</p>
<pre style="color:#93a1a1;background-color:#002b36">rawhttp send my-request.req -p stats

Connect time: 179.35 ms
First received byte time: 698.79 ms
Total response time: 713.03 ms
Bytes received: <span style="color:#2aa198">464</span>
Throughput <span style="color:#719e07">(</span>bytes/sec<span style="color:#719e07">)</span>: <span style="color:#2aa198">32572</span>
</pre>
<h4>Send a HTTP request from text</h4>
<pre style="color:#93a1a1;background-color:#002b36">rawhttp send -t <span style="color:#2aa198">&#34;
</span><span style="color:#2aa198">GET http://example.com/hello
</span><span style="color:#2aa198">User-Agent: my-client
</span><span style="color:#2aa198">Accept: text/html&#34;</span>
</pre>
<h4>Send a HTTP request from stdin</h4>

<p>If neither the <code>-t</code> nor the <code>-f</code> options are used, the request is read from <code>stdin</code>.</p>

<p>Just start typing:</p>
<pre style="color:#93a1a1;background-color:#002b36">rawhttp send
&gt; GET http://example.com/hello
&gt; User-Agent: my-client
&gt; Accept: text/html
&gt;
</pre>
<p>You can also pipe the request from another command:</p>
<pre style="color:#93a1a1;background-color:#002b36">cat my-request.req | rawhttp send
</pre>
<h4>Use a file as message body</h4>

<p>Assuming a JSON file called <code>body.json</code> exists in the working directory:</p>
<pre style="color:#93a1a1;background-color:#002b36">rawhttp send --body-file body.json -t <span style="color:#2aa198">&#34;
</span><span style="color:#2aa198">POST http://example.com/hello
</span><span style="color:#2aa198">Accept: application/json
</span><span style="color:#2aa198">Content-Type: application/json
</span><span style="color:#2aa198">&#34;</span>
</pre>
<hr>

<h3>Using the <code>run</code> command</h3>

<p>The <code>run</code> sub-command executes an HTTP file as defined by <a href="https://www.jetbrains.com/help/idea/http-client-in-product-code-editor.html">Jetbrains</a>.</p>

<p>Usage:</p>
<pre style="color:#93a1a1;background-color:#002b36">rawhttp run &lt;http-file&gt; <span style="color:#719e07">[</span>options<span style="color:#719e07">]</span>
</pre>
<p>Options:</p>
<pre style="color:#93a1a1;background-color:#002b36">* -e --environment &lt;name&gt;
      the name of the environment to use
* -c --cookiejar &lt;file&gt;
      the file to use as a cookie jar
* -p --print-response-mode
      one of: response|all|body|status|stats
        - response: <span style="color:#719e07">(</span>default<span style="color:#719e07">)</span> print the full responses
        - all: print the full response and statistics about each request
        - body: print the response bodies
        - status: print the response status-lines
        - stats: print statistics about each request
* -l --log-request
      log the request
</pre>
<p>The <code>stats</code> argument of the <code>print-response-mode</code> option works as for the <code>send</code> command.</p>

<h4>Example HTTP file</h4>

<p>The following shows an example HTTP file that sends a GET request, then a POST request:</p>
<pre style="color:#93a1a1;background-color:#002b36"># This is a HTTP file <span style="color:#719e07">in</span> the format specified <span style="color:#719e07">in</span> https<span style="color:#719e07">:</span><span style="color:#586e75">//github.com/JetBrains/http-request-in-editor-spec
</span><span style="color:#586e75"></span>#
# You can run <span style="color:#719e07">this</span> file <span style="color:#719e07">in</span> IntelliJ IDEA, or using the rawhttp<span style="color:#719e07">-</span>cli.

### GET request <span style="color:#268bd2">with</span> parameter
GET https<span style="color:#719e07">:</span><span style="color:#586e75">//httpbin.org/get?show_env=1
</span><span style="color:#586e75"></span>Accept<span style="color:#719e07">:</span> application<span style="color:#719e07">/</span>json

<span style="color:#719e07">&gt;</span> {<span style="color:#719e07">%</span>
client.test(<span style="color:#2aa198">&#34;Request executed successfully&#34;</span>, <span style="color:#268bd2">function</span>() {
  client.assert(response.status <span style="color:#719e07">===</span> <span style="color:#2aa198">200</span>, <span style="color:#2aa198">&#34;Response status is not 200&#34;</span>);
});
<span style="color:#719e07">%</span>}
<span style="color:#719e07">&lt;</span><span style="color:#719e07">&gt;</span> response.json

### Send POST request <span style="color:#268bd2">with</span> body as parameters
POST https<span style="color:#719e07">:</span><span style="color:#586e75">//httpbin.org/post
</span><span style="color:#586e75"></span>Content<span style="color:#719e07">-</span>Type<span style="color:#719e07">:</span> application<span style="color:#719e07">/</span>x<span style="color:#719e07">-</span>www<span style="color:#719e07">-</span>form<span style="color:#719e07">-</span>urlencoded
X<span style="color:#719e07">-</span>Content<span style="color:#719e07">-</span>Type<span style="color:#719e07">-</span>Options<span style="color:#719e07">:</span> nosniff

id<span style="color:#719e07">=</span><span style="color:#2aa198">999</span><span style="color:#719e07">&amp;</span>value<span style="color:#719e07">=</span>content

<span style="color:#719e07">&gt;</span> {<span style="color:#719e07">%</span>
client.test(<span style="color:#2aa198">&#34;Request executed successfully&#34;</span>, <span style="color:#268bd2">function</span>() {
  client.assert(response.status <span style="color:#719e07">===</span> <span style="color:#2aa198">200</span>, <span style="color:#2aa198">&#34;Response status is not 200&#34;</span>);
  client.assert(response.contentType.mimeType <span style="color:#719e07">===</span> <span style="color:#2aa198">&#39;application/json&#39;</span>, <span style="color:#2aa198">&#34;Not JSON: &#34;</span> <span style="color:#719e07">+</span> response.contentType);
  <span style="color:#586e75">// validate the body
</span><span style="color:#586e75"></span>  <span style="color:#268bd2">var</span> json <span style="color:#719e07">=</span> response.body;
  client.assert(json.form.id <span style="color:#719e07">===</span> <span style="color:#2aa198">&#39;999&#39;</span>, <span style="color:#2aa198">&#34;Unexpected JSON: &#34;</span> <span style="color:#719e07">+</span> json);
  client.assert(json.form.value <span style="color:#719e07">===</span> <span style="color:#2aa198">&#39;content&#39;</span>, <span style="color:#2aa198">&#34;Unexpected JSON: &#34;</span> <span style="color:#719e07">+</span> json);
  client.assert(json.headers[<span style="color:#2aa198">&#39;X-Content-Type-Options&#39;</span>] <span style="color:#719e07">===</span> <span style="color:#2aa198">&#39;nosniff&#39;</span>, <span style="color:#2aa198">&#34;Unexpected JSON: &#34;</span> <span style="color:#719e07">+</span> json);
});
<span style="color:#719e07">%</span>}
</pre>
<p>To run this file, say it&rsquo;s called <code>test.http</code>:</p>
<pre style="color:#93a1a1;background-color:#002b36">rawhttp run test.http
</pre>
<h4>Dynamic variables</h4>

<p>Dynamic variables generate a value each time you run a request:</p>

<ul>
<li><code>$uuid</code>: generates a universally unique identifier (UUID-v4)</li>
<li><code>$timestamp</code>: generates the current UNIX timestamp</li>
<li><code>$randomInt</code>: generates a random integer between 0 and 1000.</li>
</ul>

<p>For example:</p>
<pre style="color:#93a1a1;background-color:#002b36">GET http://localhost/api/get?id={{$uuid}}
</pre>
<h4>Environments</h4>

<p>An environment is a JSON file which defines variables that can be used in HTTP files.</p>

<p>The file must be named <code>http-client.env.json</code>, and the <code>http-client.private.env.json</code> file holds the
sensitive authorization data.</p>

<p>The top-level keys in the JSON object are the names of the environments. For example, the following file defines
two environments, <code>development</code> and <code>production</code>:</p>
<pre style="color:#93a1a1;background-color:#002b36">{
    <span style="color:#268bd2">&#34;development&#34;</span>: {
        <span style="color:#268bd2">&#34;host&#34;</span>: <span style="color:#2aa198">&#34;localhost&#34;</span>,
        <span style="color:#268bd2">&#34;id-value&#34;</span>: <span style="color:#2aa198">12345</span>,
        <span style="color:#268bd2">&#34;username&#34;</span>: <span style="color:#2aa198">&#34;joe&#34;</span>,
        <span style="color:#268bd2">&#34;password&#34;</span>: <span style="color:#2aa198">&#34;123&#34;</span>,
        <span style="color:#268bd2">&#34;my-var&#34;</span>: <span style="color:#2aa198">&#34;my-dev-value&#34;</span>
    },

    <span style="color:#268bd2">&#34;production&#34;</span>: {
        <span style="color:#268bd2">&#34;host&#34;</span>: <span style="color:#2aa198">&#34;example.com&#34;</span>,
        <span style="color:#268bd2">&#34;id-value&#34;</span>: <span style="color:#2aa198">6789</span>,
        <span style="color:#268bd2">&#34;username&#34;</span>: <span style="color:#2aa198">&#34;bob&#34;</span>,
        <span style="color:#268bd2">&#34;password&#34;</span>: <span style="color:#2aa198">&#34;345&#34;</span>,
        <span style="color:#268bd2">&#34;my-var&#34;</span>: <span style="color:#2aa198">&#34;my-prod-value&#34;</span>
    }
}
</pre>
<p>The following request could be used with this environment:</p>
<pre style="color:#93a1a1;background-color:#002b36">GET http://{{host}}/api/json/get?id={{id-value}}
Authorization: Basic {{username}} {{password}}
Content-Type: application/json

{
&#34;key&#34;: {{my-var}}
}
</pre>
<p>To run that with the <code>development</code> environment:</p>
<pre style="color:#93a1a1;background-color:#002b36">rawhttp run req.http -e development
</pre>
<hr>

<h3>Using the <code>serve</code> command</h3>

<p>The <code>serve</code> command starts up a HTTP server to serve the contents of a directory.</p>

<p>Paths may match a file name with or without its extension.
If more than one file exists with the same name but different extensions, the server attempts
to use the request <code>Accept</code> header to disambiguate.</p>

<p>Usage:</p>
<pre style="color:#93a1a1;background-color:#002b36">rawhttp serve &lt;dir&gt; [options]
</pre>
<p>Options:</p>
<pre style="color:#93a1a1;background-color:#002b36">* -l --log-requests
      log requests received by the server
* -m --media-types &lt;file&gt;
      use custom Media-Type mappings
* -p --port &lt;port-number&gt;
      the port to listen on
</pre>
<h4>Serve files from a local directory</h4>

<p>To serve the local directory <code>public/</code> on the default port:</p>
<pre style="color:#93a1a1;background-color:#002b36">rawhttp serve public/
</pre>
<p>Enable a request logger (prints to stdout):</p>
<pre style="color:#93a1a1;background-color:#002b36">rawhttp serve public/ -l
</pre>
<p>Use a different port, say 8082:</p>
<pre style="color:#93a1a1;background-color:#002b36">rawhttp serve public/ -p <span style="color:#2aa198">8082</span>
</pre>
<h4>Provide custom media-type mapping</h4>

<p>The CLI HTTP Server, by default, maps only a few common file extensions to a proper
<a href="http://www.iana.org/assignments/media-types/media-types.xhtml">Media Type</a>.</p>

<p>To override or just provide extra mappings, start the server with a <code>--media-types</code> flag:</p>
<pre style="color:#93a1a1;background-color:#002b36">rawhttp serve public/ --media-types my-media-types.properties
</pre>
<p>A properties file with mappings should contain entries where the key is a file extension,
 and the value a media-type. It might look something like this:</p>
<pre style="color:#93a1a1;background-color:#002b36">sql: application/sql
soap+xml: application/soap+xml
ac3: audio/ac3
3gpp: video/3gpp
mpeg: video/mpeg4-generic
</pre>
<p>Unmapped file extensions result in the <code>Content-Type</code> header being set to <code>application/octet-stream</code>.</p>

<hr>
</div>
<footer class="footer">
    <div>
        <small>
            RawHTTP is a project by <a href="https://github.com/renatoathaydes">Renato Athaydes</a>
        </small>
    </div>
    <div>
        <small>Sources on <a href="https://github.com/renatoathaydes/rawhttp">GitHub</a></small>
    </div>
</footer>
</body>
</html>